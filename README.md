# Хеш-таблица
**Хеш-таблица** - таблица, которая хранит данные в формате ключ-значение. Ключ вычисляется специальной функцией - *хеш-функцией*. В данном проекте хеш-таблица реализована методом цепочек.

![alt text](image.png)

В этом методе реализации коллизии (когда значения хеш-функций для двух ключей совпадают) разрешаются с помощью "цепочпек" - списки ключей с одинаковыми значениями.



Анализ хеш-функций можно посмотреть здесь: https://github.com/SashaKhaytina/Algorithms_Labs/tree/master/Lab_5_hashes

В учебных целях была взята хеш-функция ```CRC32```.


# Оптимизации хеш-таблицы на ассемблере

Здесь оптимизировался только поиск в хеш-таблице. Для того, чтоб определить какую функцию оптимизировать, изпользовался профилировщик `callgrind`. 







### Без ассемблерных оптимизаций
Запустим программу без оптимизаций, только с флагом `-O2`.

<!-- Время работы (в среднем) - $14.506$ c -->

Отчет профилировщика:
<!-- ![alt text](<statistic_1.png>) -->
![alt text](<Pictures/statistic_11.png>)

Дольше всех работает `strcmp()`. Будем оптимизировать сначала ее.









### С оптимизацией `strcmp()`
Напишем оптимизацию функции `strcmp()`. Для этого написана своя функция `ASM_strcmp()` на ассемблере. Теперь вместо `strcmp()` будем использовать ее.

Запустим программу с нашей оптимизацией и флагом `-O2`.

<!--Время работы (в среднем) - $10.799$ c -->


Отчет профилировщика:
<!-- ![alt text](<statistic_2.png>) -->
![alt text](<Pictures/statistic_22.png>)


|Оптимизация|Ускорение относительно начала|Ускорение относительно предыдущего|
|:-----:|:-----:|:------:|
|`NO`|$1.0000$|$1.0000$|
|`Asm_strcmp`|$0.7188$|$0.7188$|

В таблице считаем ускорение функции `list_find`.

Далее будем оптимизировать функцию `hash_function_CRC32`.








### С оптимизацией `hash_function_CRC32()`
Напишем оптимизацию хеш-функции с помощью функций intrinsic, для повышения производительности.

<!--Время работы (в среднем) - $14.506$ c-->

Отчет профилировщика:
![alt text](<Pictures/statistic_33.png>)

|Оптимизация|Ускорение относительно начала|Ускорение относительно предыдущего|
|:-----:|:-----:|:------:|
|`NO`|$1.0000$|$1.0000$|
|`Asm_strcmp`|$0.7188$|$0.7188$|
|`Asm_strcmp` и `hash_function_CRC32`|$0.7158$|$0.9958$|

Все остальные функции занимают незначительно времени от выполнения программы. Далее попробуем соптимизировать саму функцию `list_find`, то есть << её `self` >>.



### С оптимизацией `list_find()`
Напишем оптимизацию `list_find` с помощью ассемблерных вставок.

<!--Время работы (в среднем) - $14.506$ c-->

Отчет профилировщика:
![alt text](<Pictures/statistic_44.png>)

|Оптимизация|Ускорение относительно начала|Ускорение относительно предыдущего|
|:-----:|:-----:|:------:|
|`NO`|$1.0000$|$1.0000$|
|`Asm_strcmp`|$0.7188$|$0.7188$|
|`Asm_strcmp` и `hash_function_CRC32`|$0.7158$|$0.9958$|
|`Asm_strcmp` и `hash_function_CRC32` и `list_find`|0.7427|1.0376|

Эта <<оптимизация>> оказалась неудачной, поэтому ее не стоит использовать. Будем использовать только две предыдущие. 


## Заключение
У нас получилось соптимизировать поиск в хеш-таблице примерно на $29$%. 

|Оптимизация|Ускорение относительно начала|Ускорение относительно предыдущего|
|:-----:|:-----:|:------:|
|`NO`|$1.0000$|$1.0000$|
|`Asm_strcmp`|$0.7188$|$0.7188$|
|`Asm_strcmp` и `hash_function_CRC32`|$0.7158$|$0.9958$|
|~~`Asm_strcmp` и `hash_function_CRC32` и `list_find`~~|~~0.7427~~|~~1.0376~~|



## Запуск
Скопируйте проект. 

Зайтем найдите текстовый файл, слова которого положатся в хеш-таблицу и поочередно запускайте:
```
./run_processing_text.sh
./processing <TEXT_FILE_WITH_WORDS_PATH>
./run_programm.sh
./hashtable
```
